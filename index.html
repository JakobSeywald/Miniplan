<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Miniplan Abmeldung</title>
<style>
body { font-family: sans-serif; padding: 20px; max-width: 600px; margin:auto; }
h1, h2 { text-align: center; }
select, button { font-size: 18px; padding: 8px; margin: 5px 0; width: 100%; }
.gottesdienst { display: flex; justify-content: space-between; margin: 8px 0; }
button.nein { background-color: #f44336; color: white; border: none; border-radius: 5px; padding: 6px 12px; }
button.ja { background-color: #4CAF50; color: white; border: none; border-radius: 5px; padding: 6px 12px; }
.abgemeldet { text-decoration: line-through; color: #888; }
</style>
</head>
<body>
<h1>Miniplan Abmeldung</h1>

<h2>Wähle deinen Namen</h2>
<select id="miniName">
  <option value="">-- Name wählen --</option>
</select>

<h2>Gottesdienste</h2>
<div id="gottesdienste"></div>

<button id="speichern">Abmeldung speichern</button>

<hr>
<h2>Planungsübersicht (nur für dich)</h2>
<div id="planung"></div>

<script>
// --- Beispiel-Daten ---
const minis = ["Max Mustermann","Anna Müller","Lukas Schmid","Jonas Becker","Lena Fischer"];
const gottesdienste = [
  {datum:"14.01.2026", uhrzeit:"10:30", anlass:"Pfarrmesse"},
  {datum:"20.01.2026", uhrzeit:"18:00", anlass:"Vorabendmesse"},
  {datum:"25.12.2026", uhrzeit:"22:00", anlass:"Christmette"}
];

// --- Local Storage für Abmeldungen ---
let abmeldungen = JSON.parse(localStorage.getItem("abmeldungen")) || {};

// --- Dropdown Minis ---
const miniSelect = document.getElementById("miniName");
minis.forEach(name => {
  const opt = document.createElement("option");
  opt.value = name;
  opt.textContent = name;
  miniSelect.appendChild(opt);
});

// --- Gottesdienste anzeigen ---
const gDiv = document.getElementById("gottesdienste");
function renderGottesdienste() {
  gDiv.innerHTML = "";
  gottesdienste.forEach((gd,i)=>{
    const div = document.createElement("div");
    div.className = "gottesdienst";
    div.innerHTML = `
      <span>${gd.datum} ${gd.uhrzeit} ${gd.anlass}</span>
      <div>
        <button class="ja">Ja</button>
        <button class="nein">Nein</button>
      </div>
    `;
    const key = `${miniSelect.value}_${i}`;
    if(abmeldungen[key] === "nein") div.querySelector(".nein").style.backgroundColor = "#c62828";
    div.querySelector(".ja").onclick = ()=>{ abmeldungen[key]="ja"; renderGottesdienste(); };
    div.querySelector(".nein").onclick = ()=>{ abmeldungen[key]="nein"; renderGottesdienste(); };
    gDiv.appendChild(div);
  });
}

// --- Speichern ---
document.getElementById("speichern").onclick = ()=>{
  localStorage.setItem("abmeldungen", JSON.stringify(abmeldungen));
  renderPlanung();
  alert("Abmeldungen gespeichert!");
};

// --- Planung anzeigen ---
function renderPlanung() {
  const pDiv = document.getElementById("planung");
  pDiv.innerHTML = "";
  gottesdienste.forEach((gd,i)=>{
    const gdDiv = document.createElement("div");
    gdDiv.innerHTML = `<strong>${gd.datum} ${gd.uhrzeit} ${gd.anlass}</strong><br>`;
    minis.forEach(mini=>{
      const key = `${mini}_${i}`;
      const status = abmeldungen[key] || "ja";
      const span = document.createElement("span");
      span.textContent = mini;
      if(status==="nein") span.className="abgemeldet";
      gdDiv.appendChild(span);
      gdDiv.appendChild(document.createTextNode(" | "));
    });
    pDiv.appendChild(gdDiv);
    pDiv.appendChild(document.createElement("hr"));
  });
}

// --- Wenn Name gewählt, rendern ---
miniSelect.onchange = renderGottesdienste;

// Initial Planung rendern
renderPlanung();
</script>
</body>
</html>
